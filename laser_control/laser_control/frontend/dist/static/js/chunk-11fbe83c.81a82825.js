(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11fbe83c"],{"1c49":function(e,t,i){"use strict";i.d(t,"c",function(){return r}),i.d(t,"b",function(){return n}),i.d(t,"d",function(){return o}),i.d(t,"a",function(){return l});var a=i("b775");function r(e){return Object(a["a"])({url:"/node_config/list",method:"get",params:e})}function n(e){return Object(a["a"])({url:"/node_config/store",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/node_config/update",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/node_config/delete",method:"post",data:e})}},"285e":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("\n      添加\n    ")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"ID",width:"95",type:"index"}}),e._v(" "),i("el-table-column",{attrs:{label:"节点配置名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.Name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"BlockCacheSizeGb"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.BlockCacheSizeGb))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"WriteBufferSizeGb"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.WriteBufferSizeGb))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"NumShardBits"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.NumShardBits))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"HighPriPoolRatio"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.HighPriPoolRatio))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"StrictCapacityLimit"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.capacityLimitText[t.row.StrictCapacityLimit]))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center",width:"150","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate(a)}}},[e._v("修改")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.deleteNodeConfig(a)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("div",{staticClass:"pagination-class"},[i("el-pagination",{attrs:{background:!0,"current-page":e.listQuery.Page,"page-size":e.listQuery.Limit,layout:"total, prev, pager, next, jumper",total:e.listTotal},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:e.formRefs[0],staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"150px"}},[i("el-form-item",{attrs:{label:"节点配置名称",prop:"Name"}},[i("el-input",{attrs:{disabled:"update"==e.dialogStatus},model:{value:e.temp.Name,callback:function(t){e.$set(e.temp,"Name",t)},expression:"temp.Name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"BlockCacheSizeGb",prop:"BlockCacheSizeGb"}},[i("el-input",{attrs:{type:"number",oninput:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.temp.BlockCacheSizeGb,callback:function(t){e.$set(e.temp,"BlockCacheSizeGb",e._n(t))},expression:"temp.BlockCacheSizeGb"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"WriteBufferSizeGb",prop:"WriteBufferSizeGb"}},[i("el-input",{attrs:{type:"number",oninput:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.temp.WriteBufferSizeGb,callback:function(t){e.$set(e.temp,"WriteBufferSizeGb",e._n(t))},expression:"temp.WriteBufferSizeGb"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"NumShardBits",prop:"NumShardBits"}},[i("el-input",{attrs:{type:"number",oninput:"value=value.replace(/[^0-9|^\\\\-|^\\\\.]/g,\\'\\')"},model:{value:e.temp.NumShardBits,callback:function(t){e.$set(e.temp,"NumShardBits",e._n(t))},expression:"temp.NumShardBits"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"HighPriPoolRatio",prop:"HighPriPoolRatio"}},[i("el-input",{attrs:{type:"number",oninput:"value=value.replace(/[^0-9|^\\\\-|^\\\\.]/g,\\'\\')"},model:{value:e.temp.HighPriPoolRatio,callback:function(t){e.$set(e.temp,"HighPriPoolRatio",e._n(t))},expression:"temp.HighPriPoolRatio"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"StrictCapacityLimit",prop:"StrictCapacityLimit"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.temp.StrictCapacityLimit,callback:function(t){e.$set(e.temp,"StrictCapacityLimit",t)},expression:"temp.StrictCapacityLimit"}},[i("el-option",{attrs:{label:"true",value:1}}),e._v(" "),i("el-option",{attrs:{label:"false",value:0}})],1)],1)],1),e._v(" "),i("h3",[e._v("IO 限速策略")]),e._v(" "),i("el-divider"),e._v(" "),i("el-form",{ref:e.formRefs[1],staticStyle:{"margin-left":"50px"},attrs:{model:e.formRateLimitData,"label-position":"left","label-width":"150px",size:"mini",rules:e.rules}},[e._l(e.formRateLimitData.RateLimitStrategy,function(t,a){return i("el-row",{key:a,attrs:{gutter:5}},[i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"时段"+(a+1),prop:"RateLimitStrategy."+a+".BeginHour",rules:e.rules.RateLimitBeginHour}},[i("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"01:00",end:"24:00"},placeholder:"起始时间"},model:{value:t.BeginHour,callback:function(i){e.$set(t,"BeginHour",i)},expression:"item.BeginHour"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"","label-width":"0px",prop:"RateLimitStrategy."+a+".EndHour",rules:e.rules.RateLimitEndHour}},[i("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"01:00",end:"24:00",minTime:t.BeginHour},placeholder:"结束时间"},model:{value:t.EndHour,callback:function(i){e.$set(t,"EndHour",i)},expression:"item.EndHour"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"","label-width":"0px",prop:"RateLimitStrategy."+a+".RateBytesPerSec",rules:e.rules.RateLimitRateBytesPerSec}},[i("el-input",{attrs:{type:"number",min:"0",oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:"输入限速值(Byte)"},model:{value:t.RateBytesPerSec,callback:function(i){e.$set(t,"RateBytesPerSec",e._n(i))},expression:"item.RateBytesPerSec"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:3}},[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return i.preventDefault(),e.removeRateLimit(t)}}},[e._v("删除")])],1)],1)}),e._v(" "),i("el-form-item",[i("el-button",{on:{click:function(t){return e.addRateLimit()}}},[e._v("新增时段")])],1)],2),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("\n        取消\n      ")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v("\n        提交\n      ")])],1)],1)],1)},r=[],n=(i("5df3"),i("ac6a"),i("1c49")),o=i("6724"),l=i("cf45"),s={directives:{waves:o["waves"]},data:function(){return{list:null,listTotal:void 0,currentPage:1,listLoading:!0,nodeConfigDelete:{NodeConfigId:void 0},listQuery:{Page:1,Limit:20,ConfigName:""},dialogFormVisible:!1,textMap:{create:"创建节点配置",update:"修改节点配置"},capacityLimitText:{0:"false",1:"true"},dialogStatus:"create",listNMLoading:!0,dataConfigNameList:null,formRefs:["formBasicInfo","formRateLimit"],formRateLimitData:{RateLimitStrategy:[]},temp:{},rules:{Name:[{required:!0,message:"配置名称是必填项"}],BlockCacheSizeGb:[{required:!0,message:"BlockCacheSizeGb是必填项"},{type:"number",message:"请输入数字格式"}],WriteBufferSizeGb:[{required:!0,message:"WriteBufferSizeGb是必填项"},{type:"number",message:"请输入数字格式"}],NumShardBits:[{required:!0,message:"NumShardBits是必填项"},{type:"number",message:"请输入数字格式"}],HighPriPoolRatio:[{required:!0,message:"HighPriPoolRatio是必填项"},{type:"number",message:"请输入数字格式"}],StrictCapacityLimit:[{required:!0,message:"StrictCapacityLimit是必填项"},{type:"number",message:"请输入数字格式"}],RateLimitBeginHour:[{required:!0,message:"开始时间是必填项"}],RateLimitEndHour:[{required:!0,message:"结束时间是必填项"}],RateLimitRateBytesPerSec:[{required:!0,message:"限速值是必填项"},{type:"number",message:"请输入数字格式"}]}}},created:function(){this.fetchData(),this.resetTemp()},methods:{fetchData:function(){var e=this;this.listLoading=!0,Object(n["c"])(this.listQuery).then(function(t){e.list=t.Data.Items,e.listTotal=t.Data.Total,e.listLoading=!1})},handleFilter:function(){this.listQuery.Page=1,this.fetchData()},resetTemp:function(){this.temp=this.newNodeConfig(),this.formRateLimitData.RateLimitStrategy=[]},handleCreate:function(){var e=this;this.resetTemp(),this.dialogFormVisible=!0,this.dialogStatus="create",this.$nextTick(function(){e.formRefs.forEach(function(t){Object(l["b"])(e,t)})})},createData:function(){var e=this,t=[];this.formRefs.forEach(function(i){t.push(Object(l["a"])(e,i))}),Promise.all(t).then(function(){e.validateRateLimitStrategy()?(e.temp.RateLimitStrategy=e.convertFormRateLimitDataToStoredData(e.formRateLimitData.RateLimitStrategy),Object(n["b"])(e.temp).then(function(t){e.$notify({title:"Success",message:"Created Successfully",type:"success",duration:2e3}),e.fetchData()}),e.dialogFormVisible=!1):e.$alert("IO 限速策略时段有重叠，请检查！","提示",{confirmButtonText:"确定",type:"error"})})},handleUpdate:function(e){var t=this;this.temp=e,this.formRateLimitData.RateLimitStrategy=this.convertStoredRateLimitDataToFormData(e.RateLimitStrategy),this.dialogFormVisible=!0,this.dialogStatus="update",this.$nextTick(function(){t.formRefs.forEach(function(e){Object(l["b"])(t,e)})})},deleteNodeConfig:function(e){var t=this;this.nodeConfigDelete.NodeConfigId=e.Id,this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n["a"])(t.nodeConfigDelete).then(function(e){t.$notify({title:"Success",message:"Delete Successfully",type:"success",duration:2e3}),t.fetchData()})})},updateData:function(){var e=this,t=[];this.formRefs.forEach(function(i){t.push(Object(l["a"])(e,i))}),Promise.all(t).then(function(){e.validateRateLimitStrategy()?(e.temp.RateLimitStrategy=e.convertFormRateLimitDataToStoredData(e.formRateLimitData.RateLimitStrategy),Object(n["d"])(e.temp).then(function(t){e.$notify({title:"Success",message:"Update Successfully",type:"success",duration:2e3}),e.fetchData()}),e.dialogFormVisible=!1):e.$alert("IO 限速策略时段有重叠，请检查！","提示",{confirmButtonText:"确定",type:"error"})})},fetchDataTable:function(){var e=this;this.listNMLoading=!0,Object(n["c"])(this.listQuery).then(function(t){e.dataConfigNameList=t.Data.Items,e.listNMLoading=!1})},handleCurrentChange:function(e){this.listQuery.Page=e,this.fetchData()},validateRateLimitStrategy:function(){var e=this.convertFormRateLimitDataToStoredData(this.formRateLimitData.RateLimitStrategy),t=i("8540"),a=t();e.forEach(function(e){a.set(e.BeginHour,e.EndHour)});var r=a.iterator(),n=JSON.parse(JSON.stringify(r.next()));if(n.done)return!0;var o=JSON.parse(JSON.stringify(r.next()));while(!o.done){if(console.log(n.value),console.log(o.value),n.value.key>=n.value.value||o.value.key>=o.value.value||n.value.value>o.value.key)return!1;n=o,o=JSON.parse(JSON.stringify(r.next()))}return!0},addRateLimit:function(){console.log(this.formRateLimitData);var e=this.formRateLimitData.RateLimitStrategy;null!==e&&e.push({Name:"",LimitType:"",LimitValue:void 0})},removeRateLimit:function(e){var t=this.formRateLimitData.RateLimitStrategy;if(null!==t){var i=t.indexOf(e);-1!==i&&t.splice(i,1)}},convertFormRateLimitDataToStoredData:function(e){var t=[];return e.forEach(function(e){var i={BeginHour:Object(l["e"])(e.BeginHour),EndHour:Object(l["e"])(e.EndHour),RateBytesPerSec:e.RateBytesPerSec};t.push(i)}),t},convertStoredRateLimitDataToFormData:function(e){var t=[];return e.forEach(function(e){var i={BeginHour:Object(l["d"])(e.BeginHour),EndHour:Object(l["d"])(e.EndHour),RateBytesPerSec:e.RateBytesPerSec};t.push(i)}),t},newNodeConfig:function(){return{Id:void 0,Name:"",BlockCacheSizeGb:void 0,WriteBufferSizeGb:void 0,NumShardBits:void 0,HighPriPoolRatio:void 0,StrictCapacityLimit:void 0,RateLimitStrategy:[]}}}},u=s,c=i("2877"),m=Object(c["a"])(u,a,r,!1,null,null,null);t["default"]=m.exports},6724:function(e,t,i){"use strict";i("8d41");var a="@@wavesContext";function r(e,t){function i(i){var a=Object.assign({},t.value),r=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),n=r.ele;if(n){n.style.position="relative",n.style.overflow="hidden";var o=n.getBoundingClientRect(),l=n.querySelector(".waves-ripple");switch(l?l.className="waves-ripple":(l=document.createElement("span"),l.className="waves-ripple",l.style.height=l.style.width=Math.max(o.width,o.height)+"px",n.appendChild(l)),r.type){case"center":l.style.top=o.height/2-l.offsetHeight/2+"px",l.style.left=o.width/2-l.offsetWidth/2+"px";break;default:l.style.top=(i.pageY-o.top-l.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",l.style.left=(i.pageX-o.left-l.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return l.style.backgroundColor=r.color,l.className="waves-ripple z-active",!1}}return e[a]?e[a].removeHandle=i:e[a]={removeHandle:i},i}var n={bind:function(e,t){e.addEventListener("click",r(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[a].removeHandle,!1),e.addEventListener("click",r(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[a].removeHandle,!1),e[a]=null,delete e[a]}},o=function(e){e.directive("waves",n)};window.Vue&&(window.waves=n,Vue.use(o)),n.install=o},"8d41":function(e,t,i){},cf45:function(e,t,i){"use strict";i.d(t,"c",function(){return r}),i.d(t,"e",function(){return n}),i.d(t,"d",function(){return o}),i.d(t,"a",function(){return l}),i.d(t,"b",function(){return s});i("6b54"),i("f576"),i("28a5");var a=i("768b");function r(){return{Id:0,NodeId:void 0,Active:0,Status:1,Host:"",Port:void 0,Weight:0,Master:!1,IsEdgeNode:!1,Desc:"",GroupId:0,GroupName:"",ConfigId:0,ConfigName:"",AnsibleConfigId:void 0,AnsibleConfigName:"",LeaderShardList:"",FollowerShardList:""}}function n(e){var t=e.split(":"),i=Object(a["a"])(t,2),r=i[0];i[1];return parseInt(r)}function o(e){var t=e.toString().padStart(2,"0");return t+":00"}function l(e,t){var i=e,a=new Promise(function(e,a){var r=i.$refs[t];void 0!=r?r.validate(function(t){t?e():a()}):e()});return a}function s(e,t){e.$refs[t].clearValidate()}}}]);