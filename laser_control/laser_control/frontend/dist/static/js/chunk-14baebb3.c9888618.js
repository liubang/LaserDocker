(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14baebb3"],{"121a":function(e,t,a){"use strict";a.d(t,"a",function(){return n});var s=a("b775");function n(e){return Object(s["a"])({url:"/tools/assign_table_shard_list",method:"get",timeout:1e5,params:e})}},"3e57":function(e,t,a){},6724:function(e,t,a){"use strict";a("8d41");var s="@@wavesContext";function n(e,t){function a(a){var s=Object.assign({},t.value),n=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},s),i=n.ele;if(i){i.style.position="relative",i.style.overflow="hidden";var l=i.getBoundingClientRect(),r=i.querySelector(".waves-ripple");switch(r?r.className="waves-ripple":(r=document.createElement("span"),r.className="waves-ripple",r.style.height=r.style.width=Math.max(l.width,l.height)+"px",i.appendChild(r)),n.type){case"center":r.style.top=l.height/2-r.offsetHeight/2+"px",r.style.left=l.width/2-r.offsetWidth/2+"px";break;default:r.style.top=(a.pageY-l.top-r.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",r.style.left=(a.pageX-l.left-r.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return r.style.backgroundColor=n.color,r.className="waves-ripple z-active",!1}}return e[s]?e[s].removeHandle=a:e[s]={removeHandle:a},a}var i={bind:function(e,t){e.addEventListener("click",n(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[s].removeHandle,!1),e.addEventListener("click",n(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[s].removeHandle,!1),e[s]=null,delete e[s]}},l=function(e){e.directive("waves",i)};window.Vue&&(window.waves=i,Vue.use(l)),i.install=l},"8d41":function(e,t,a){},ad8f:function(e,t,a){"use strict";a.d(t,"d",function(){return n}),a.d(t,"e",function(){return i}),a.d(t,"a",function(){return l}),a.d(t,"g",function(){return r}),a.d(t,"b",function(){return o}),a.d(t,"f",function(){return u}),a.d(t,"c",function(){return c});var s=a("b775");function n(e){return Object(s["a"])({url:"/table/list",method:"get",params:e})}function i(e){return Object(s["a"])({url:"/table/list_detail",method:"get",params:e})}function l(e){return Object(s["a"])({url:"/table/store",method:"post",data:e})}function r(e){return Object(s["a"])({url:"/table/update",method:"post",data:e})}function o(e){return Object(s["a"])({url:"/table/delete",method:"post",data:e})}function u(){return Object(s["a"])({url:"table/synchronize",method:"post"})}function c(){return Object(s["a"])({url:"/table/list_commands",method:"get"})}},c48b:function(e,t,a){"use strict";a.d(t,"c",function(){return n}),a.d(t,"a",function(){return i}),a.d(t,"d",function(){return l}),a.d(t,"b",function(){return r});var s=a("b775");function n(e){return Object(s["a"])({url:"/database/list",method:"get",params:e})}function i(e){return Object(s["a"])({url:"/database/store",method:"post",data:e})}function l(e){return Object(s["a"])({url:"/database/update",method:"post",data:e})}function r(e){return Object(s["a"])({url:"/database/delete",method:"post",data:e})}},d9ee:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20,align:"middle"}},[a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:6}},[a("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"10px"},attrs:{rules:e.rules,model:e.assignParams,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Laser 数据库",prop:"DatabaseName"}},[a("el-select",{staticClass:"el-select",attrs:{loading:e.listDBLoading,placeholder:"请选择"},on:{"visible-change":e.fetchDatabase,change:function(t){return e.getDatabaseIdByName(e.assignParams.DatabaseName)}},model:{value:e.assignParams.DatabaseName,callback:function(t){e.$set(e.assignParams,"DatabaseName",t)},expression:"assignParams.DatabaseName"}},e._l(e.databaseList,function(e){return a("el-option",{key:e.Id,attrs:{label:e.Name,value:e.Name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Laser 数据表",prop:"TableName"}},[a("el-select",{staticClass:"el-select",attrs:{loading:e.listTableLoading,placeholder:"请选择"},on:{"visible-change":e.fetchDataTable},model:{value:e.assignParams.TableName,callback:function(t){e.$set(e.assignParams,"TableName",t)},expression:"assignParams.TableName"}},e._l(e.tableList,function(e){return a("el-option",{key:e.Id,attrs:{label:e.Name,value:e.Name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分配方式",prop:"Type"}},[a("el-select",{staticClass:"el-select",attrs:{placeholder:"请选择"},model:{value:e.assignParams.Type,callback:function(t){e.$set(e.assignParams,"Type",t)},expression:"assignParams.Type"}},e._l(e.assignTypes,function(e){return a("el-option",{key:e.Value,attrs:{label:e.Name,value:e.Value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分配列表个数",prop:"AssignedListNum"}},[a("el-input",{attrs:{type:"number",min:"0",oninput:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.assignParams.AssignedListNum,callback:function(t){e.$set(e.assignParams,"AssignedListNum",e._n(t))},expression:"assignParams.AssignedListNum"}})],1),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"330px"},attrs:{type:"primary"},on:{click:e.assignTableShard}},[e._v("\n          分配\n        ")])],1)],1)],1),e._v(" "),a("p",[e._v("分配后的分片")]),e._v(" "),a("el-divider",{staticStyle:{margin:"10px"}}),e._v(" "),a("el-row",{attrs:{gutter:20,align:"middle"}},[a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:6}},[a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.copyAllLists}},[e._v("\n        复制分片列表\n      ")])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20,align:"middle"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{"margin-left":"10px"},attrs:{data:e.assignResult.AssignedShardListInfos,"element-loading-text":"Loading","show-summary":"","summary-method":e.getSummaries,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"ID",width:"120",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"分片列表"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(JSON.stringify(t.row.ShardList)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"占用空间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.bytesToSize(t.row.SizeSum)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"KPS"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.KpsSum))])]}}])})],1)],1)],1)},n=[],i=(a("ac6a"),a("ad8f")),l=a("c48b"),r=a("121a"),o=a("6724"),u=a("5c96"),c={directives:{waves:o["waves"]},data:function(){return{assignResult:{TotalShardListInfo:[],AssignedShardListInfos:[]},listLoading:!1,assignTypes:[{Name:"ShardSize",Value:1},{Name:"ShardKps",Value:2},{Name:"ShardNum",Value:3}],assignParams:{DatabaseName:"",TableName:"",Type:void 0,AssignedListNum:void 0},listTableParams:{Page:void 0,Limit:void 0,DatabaseId:void 0},listDBLoading:!0,listTableLoading:!0,databaseList:null,tableList:null,tableKey:0,rules:{DatabaseName:[{required:!0,message:"数据库名称是必填项"}],TableName:[{required:!0,message:"数据表名称是必填项"}],Type:[{required:!0,message:"分配类型是必填项"}],AssignedListNum:[{required:!0,message:"分配列表数量是必填项"}]}}},methods:{fetchDatabase:function(){var e=this;this.listDBLoading=!0,Object(l["c"])().then(function(t){e.databaseList=t.Data.Items,e.listDBLoading=!1})},fetchDataTable:function(){var e=this;this.listTableLoading=!0,Object(i["d"])(this.listTableParams).then(function(t){e.tableList=t.Data.Items,e.listTableLoading=!1})},getDatabaseIdByName:function(e){for(var t=0;t<this.databaseList.length;++t)if(e==this.databaseList[t].Name){this.listTableParams.DatabaseId=this.databaseList[t].Id;break}},assignTableShard:function(){var e=this;this.$refs["dataForm"].validate(function(t){t&&(e.listLoading=!0,Object(r["a"])(e.assignParams).then(function(t){e.assignResult=t.Data,console.log(e.assignResult)}).finally(function(){e.listLoading=!1}))})},getSummaries:function(e){var t=[];return t.push("总计"),t.push(JSON.stringify(this.assignResult.TotalShardListInfo.ShardList)),t.push(this.bytesToSize(this.assignResult.TotalShardListInfo.SizeSum)),t.push(this.assignResult.TotalShardListInfo.KpsSum),t},copyAllLists:function(){var e=new Array;this.assignResult.AssignedShardListInfos.forEach(function(t){e.push(t.ShardList)}),this.$copyText(JSON.stringify(e)).then(function(e){Object(u["Message"])({showClose:!0,message:"复制成功",type:"success",center:!0,duration:1e3})},function(e){Object(u["Message"])({showClose:!0,message:"复制失败",type:"warning",center:!0,duration:1e3}),console.log(e)})},bytesToSize:function(e){if(0===e)return"0 B";var t=1024,a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(e)/Math.log(t));return(e/Math.pow(t,s)).toFixed(1)+" "+a[s]}}},d=c,m=(a("de7b"),a("2877")),b=Object(m["a"])(d,s,n,!1,null,null,null);t["default"]=b.exports},de7b:function(e,t,a){"use strict";var s=a("3e57"),n=a.n(s);n.a}}]);